<!DOCTYPE html>
<html>
  <head>
    <title>AI Music Video Production Suite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;500&family=Permanent+Marker&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="index.css" />
    <script type="importmap">
      {
        "imports": {
          "@google/genai": "https://esm.sh/@google/genai@^1.4.0"
        }
      }
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-[#0a0a0a] font-['Inter'] text-gray-300 antialiased min-h-screen pb-32 flex flex-col overflow-hidden">
    
    <!-- App Container -->
    <div class="h-screen flex flex-col p-4 md:p-6 gap-4">
      
      <!-- Header -->
      <div class="flex-shrink-0 flex flex-col md:flex-row justify-between items-end border-b border-gray-800 pb-4 gap-4">
        <div>
            <h1 class="text-3xl md:text-4xl font-bold text-white tracking-tight font-['Permanent_Marker'] text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 via-orange-500 to-red-500">
            Director's Cut
            </h1>
            <p class="text-gray-500 text-xs mt-1 font-mono">
            AI Production Suite • Gemini 3.0 • Veo 3.1 • v2.0-debug
            </p>
        </div>
        <div class="flex gap-3 items-center">
             <div class="flex items-center gap-2 mr-4 bg-gray-900 border border-gray-800 rounded px-2 py-1">
                <span class="text-[10px] text-gray-500 uppercase font-bold">Transition</span>
                <select id="transition-select" class="bg-transparent text-xs text-white border-none focus:ring-0 cursor-pointer">
                    <option value="cut">Hard Cut</option>
                    <option value="crossfade">Crossfade</option>
                    <option value="fadeblack">Fade to Black</option>
                </select>
             </div>
             <button id="clear-project" class="text-xs text-red-400 hover:text-red-300 border border-red-900/30 bg-red-900/10 px-3 py-2 rounded">
                Reset
             </button>
             <div class="text-right">
                <span id="save-status" class="text-xs font-mono text-gray-600 block">Auto-save active</span>
             </div>
        </div>
      </div>

      <!-- Main Workspace Grid -->
      <div class="flex-grow grid grid-cols-1 lg:grid-cols-12 gap-6 min-h-0">
        
        <!-- Left Column: Assets & Config (Width: 3/12) -->
        <div class="lg:col-span-3 space-y-4 overflow-y-auto pr-2 custom-scrollbar">
          
          <!-- 1. Audio Assets -->
          <div class="bg-[#161616] p-3 rounded-xl border border-gray-800 shadow-lg">
             <h3 class="text-white text-xs font-semibold mb-2 flex items-center gap-2 uppercase tracking-wider text-gray-500">
                1. Audio Source
             </h3>
             <input id="audio-input" type="file" accept="audio/*" class="w-full text-xs text-gray-500 file:mr-4 file:py-1.5 file:px-3 file:rounded file:border-0 file:text-[10px] file:font-semibold file:bg-gray-800 file:text-gray-300 hover:file:bg-gray-700 transition-colors"/>
             <div class="mt-2 flex justify-between text-xs font-mono text-gray-500">
                <span id="audio-duration">00:00</span>
             </div>
             <audio id="audio-element" class="hidden"></audio>
          </div>

          <!-- 2. Settings -->
          <div class="bg-[#161616] p-3 rounded-xl border border-gray-800 space-y-3 shadow-lg">
            <h3 class="text-white text-xs font-semibold uppercase tracking-wider text-gray-500">
               2. Production Settings
            </h3>
            
            <div class="grid grid-cols-2 gap-2">
                <div>
                    <label class="block text-[10px] text-gray-500 mb-1">Aspect Ratio</label>
                    <select id="aspect-ratio" class="w-full bg-[#0a0a0a] border border-gray-700 rounded px-2 py-1.5 text-xs text-white focus:outline-none focus:border-yellow-500">
                        <option value="16:9">16:9 (Cinematic)</option>
                        <option value="9:16">9:16 (Social)</option>
                        <option value="1:1">1:1 (Square)</option>
                    </select>
                </div>
                 <div>
                    <label class="block text-[10px] text-gray-500 mb-1">Clip Length</label>
                    <select id="clip-length" class="w-full bg-[#0a0a0a] border border-gray-700 rounded px-2 py-1.5 text-xs text-white focus:outline-none focus:border-yellow-500">
                        <option value="5">5s (Standard)</option>
                        <option value="3">3s (Fast)</option>
                        <option value="8">8s (Long)</option>
                    </select>
                </div>
            </div>

            <div>
                <label class="block text-[10px] text-gray-500 mb-1">Visual Style Ref (Optional)</label>
                <input id="style-image" type="file" accept="image/*" class="w-full text-xs text-gray-500 file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-[10px] file:font-semibold file:bg-gray-800 file:text-gray-300"/>
                <img id="style-preview" class="mt-2 w-full h-24 object-cover rounded hidden border border-gray-700" />
            </div>
          </div>

          <!-- 3. Lyrics -->
          <div class="bg-[#161616] flex flex-col p-3 rounded-xl border border-gray-800 shadow-lg flex-grow">
            <h3 class="text-white text-xs font-semibold mb-2 uppercase tracking-wider text-gray-500">
               3. Lyrics / Vibe
            </h3>
            <textarea id="prompt-input" class="w-full bg-[#0a0a0a] border border-gray-700 rounded p-3 text-xs text-gray-300 focus:outline-none focus:border-yellow-500 font-mono resize-none h-40" placeholder="Paste lyrics here or describe the visual vibe..."></textarea>
            
            <button id="plan-button" class="mt-3 w-full bg-blue-600 hover:bg-blue-500 text-white font-medium py-2 px-4 rounded text-xs transition-colors shadow-lg shadow-blue-900/20 flex items-center justify-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                Plan Storyboard
            </button>
          </div>
        </div>

        <!-- Middle Column: Timeline (Width: 5/12) -->
        <div class="lg:col-span-5 flex flex-col min-h-0">
             <div class="flex items-center justify-between mb-2 px-1">
                <h3 class="text-white text-sm font-semibold flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                    Storyboard Timeline
                </h3>
                <button id="render-all-btn" disabled class="bg-green-600 disabled:bg-gray-800 disabled:text-gray-500 hover:bg-green-500 text-white px-3 py-1.5 rounded text-xs font-medium flex items-center gap-2 transition-all">
                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                    Render All Scenes
                </button>
             </div>
             
             <div id="scene-container" class="flex-grow overflow-y-auto space-y-2 pr-2 custom-scrollbar pb-20">
                <!-- Scenes injected here -->
                <div class="h-full flex flex-col items-center justify-center text-gray-700 border border-dashed border-gray-800 rounded-xl">
                    <p class="text-sm">Timeline Empty</p>
                    <p class="text-xs mt-1">Upload audio & plan storyboard to begin</p>
                </div>
             </div>
        </div>

        <!-- Right Column: Player & Console (Width: 4/12) -->
        <div class="lg:col-span-4 flex flex-col gap-4 min-h-0">
            
            <!-- Video Player -->
            <div class="bg-black rounded-xl overflow-hidden shadow-2xl border border-gray-800 aspect-video relative group">
                <!-- Dual Video Layers for seamless transitions -->
                <video id="video-layer-1" class="absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 z-10 opacity-100" playsinline muted></video>
                <video id="video-layer-2" class="absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 z-0 opacity-0" playsinline muted></video>
                
                <!-- Overlay UI -->
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                    <button id="play-pause-master" class="pointer-events-auto w-16 h-16 bg-white/10 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white/20 transition-all transform hover:scale-105 group-hover:opacity-100 opacity-0 transition-opacity">
                         <svg id="icon-play" class="ml-1 text-white fill-white" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                         <svg id="icon-pause" class="hidden text-white fill-white" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg>
                    </button>
                </div>

                <!-- Scene Info Overlay -->
                <div class="absolute top-4 left-4 right-4 flex justify-between items-start pointer-events-none">
                    <div id="now-playing-text" class="text-[10px] text-white/80 font-mono bg-black/50 px-2 py-1 rounded backdrop-blur-md">
                        Ready to play
                    </div>
                </div>

                <!-- Controls Bottom -->
                <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/90 to-transparent p-4 pt-12">
                     <!-- Progress -->
                     <div class="w-full bg-gray-700/50 h-1 rounded-full mb-2 overflow-hidden">
                        <div id="progress-bar" class="h-full bg-yellow-500 w-0 transition-all duration-100"></div>
                     </div>
                     <div class="flex justify-between text-[10px] font-mono text-gray-400">
                        <span id="current-time">00:00</span>
                        <span id="total-time">00:00</span>
                     </div>
                </div>
            </div>

            <!-- Debug Console -->
            <div class="flex-grow flex flex-col bg-[#0f0f0f] border border-gray-800 rounded-xl overflow-hidden shadow-lg min-h-0">
                <div class="bg-[#1a1a1a] px-3 py-2 border-b border-gray-800 flex justify-between items-center">
                    <span class="text-[10px] uppercase font-mono font-bold text-gray-500 flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                        Debug Console
                    </span>
                    <button id="clear-console" class="text-[10px] text-gray-600 hover:text-gray-400">Clear</button>
                </div>
                <div id="debug-output" class="flex-grow p-2 font-mono text-[10px] overflow-y-auto custom-scrollbar space-y-1">
                    <div class="text-gray-500">System initialized. Waiting for input...</div>
                </div>
            </div>

        </div>

      </div>

    </div>

    <script type="module" src="index.tsx"></script>
  </body>
</html>